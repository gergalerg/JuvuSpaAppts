{% extends "base.html" %}
{% block title %}Results{% endblock %}
{% block html_head %}
<script type="text/javascript" src="/static/js/jquery.tablesorter.min.js"></script>
<link rel="stylesheet" href="/dyn/results.css" type="text/css">
<link rel="stylesheet" href="/static/tablesorter.css" type="text/css">
<title>Results</title>
<script type="text/javascript">

$(function() {

    $("#resultsTable").tablesorter();

    $("button#search").button({
        icons: {primary:'ui-icon-circle-check'},
    }).click(function() {
        $("form").submit();
        return false;
    });

    var foo = {{ results|safe }};

    function make_tile(data, i) {
        var d = $('<div id="tile_' + i + '" class="tile"></div>');
        d.append('<div class="spa">' + data.spa + '</div>' +
                 '<div class="rating">' + data.rating + '</div>' +
                 '<div class="logo"><img src="/static/a_logo.png"></div>' +
                 '<div class="distance" distance="' + data.distance + '">' + data.distance_text + '</div>' +
                 '<div class="price">$' + data.price + '</div>');
        $("div#results").append(d);
    }

    jQuery.map(foo, make_tile);

});

</script>
{% endblock %}
{% block body %}
<div id="main_outer">

<div id="upper">
<div id="re_search">
  <form method="POST" action="{% url search %}">
    {% csrf_token %}
    <label for="treatment">What</label>
    <input name="treatment" id="treatment" class="ui-corner-all" type="text" value="{{ what }}" />
    <label for="location">Where</label>
    <input name="location" id="location" class="ui-corner-all" type="text" value="{{ where }}" />
    <button id="search">Search</button>
  </form>
</div>
</div>

<div id="header">

<div class="searchy">
<strong>Distance</strong><br>
1 mile<br>
5 miles<br>
1.7M Lightyears
</div>

<div class="searchy">
<strong>Price</strong><br>
$100 or less<br>
$101 - $1000<br>
$1001 - $5000
</div>

<div class="searchy">
<strong>Neighborhood</strong><br>
North Beach<br>
Inner Sunset<br>
Marina
</div>

<div class="clearit"></div>
</div>{# "header" #}

<div id="main">

<div id="results">
<table id="resultsTable" class="tablesorter" >
<thead><tr>
		<th>Spa</th>
		<th>Rating</th>
		<th>Distance</th>
		<th>Price</th>
</tr></thead>
<tbody>
</tbody>
</table>
</div>{# "results" #}

<div id="tools">Tools!</div>

<div class="clearit"></div>
</div>{# "main" #}

</div>{# "main_outer" #}
{% endblock %}
